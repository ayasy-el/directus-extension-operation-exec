import{exec as o}from"child_process";var e={id:"exec_cmd",handler:async({cmd:e,wait:r,timeout:t})=>{try{return await new Promise(((s,c)=>{let a=o(e),[d,l]=["",!1];const i=o=>{l||r||(l=!0,setTimeout((()=>{o()}),t??0))};a.stdout.on("data",(o=>{console.log(`stdout: ${o}`),d+=o,i((()=>{s({log:d,status:"success"})}))})),a.stderr.on("data",(o=>{console.error(`stderr: ${o}`),d+=o,i((()=>{c({log:d,status:"error"})}))})),a.on("close",(o=>{console.log(`exec process exited with code ${o}`),d+=`Exit code: ${o}`,0===o?s({log:d,status:"success",exit_code:o}):c({log:d,status:"error",exit_code:o})})),a.on("error",(o=>{console.error(`Error: ${o}`),c({log:d,error:o,status:"error"})}))}))}catch(o){throw o}}};export{e as default};
